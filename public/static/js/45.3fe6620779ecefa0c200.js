webpackJsonp([45],{kUPx:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("ryJa"),s=a.n(i),l=a("15QY"),r=a("8dnD"),o={components:{NavTemplent:l.a,TablePage:r.a},data:function(){return{siteList:[],imageUrl:"",title:"编辑物料费用",date:"",editMaterialMessage:null,materialList:[],buyTimeList:[],totalNums:[],page:{pageSize:1,pageNum:50},dialogVisible:!1,total:0,isDownload:"0",form:{web_id:"",buy_time:"",package_num:"",package_price:"",zipper_package_num:"",zipper_package_price:"",ticket_num:"",ticket_price:"",total_price:"",date:[s()(s()().valueOf()-6048e5).format("YYYY/MM/DD"),s()(s()()+864e5).format("YYYY/MM/DD")],img_path:""}}},methods:{getSiteList:function(){var t=this;this.$post("/getGaWebSitList",{pageNum:1e4,page:this.page.pageSize,website_name:this.form.siteName}).then(function(e){t.siteList=e.list})},handleAvatarSuccess:function(t,e){this.form.img_path=URL.createObjectURL(e.raw)},drawLine:function(){this.$echarts.init(document.getElementById("myChart")).setOption({title:{text:"物料费用"},xAxis:{type:"category",boundaryGap:!1,data:this.buyTimeList},yAxis:{type:"value"},series:[{data:[820,932,1330,901,1290,934,1320],type:"line",areaStyle:{}}]})},getMaterialList:function(){var t=this;this.startTime=this.$root.$options.filters.dateFormat(this.form.date[0],"YYYY/MM/DD"),this.lastTime=this.$root.$options.filters.dateFormat(this.form.date[1],"YYYY/MM/DD"),this.$post("/getMaterialList",{pageNum:this.page.pageNum,page:this.page.pageSize,lastTime:this.lastTime,startTime:this.startTime,download:this.isDownload}).then(function(e){t.total=e.count,t.materialList=e.list,t.buyTimeList=e.list.map(function(t){return s()(1e3*t.buy_time).format("YYYY/MM/DD")}),t.totalNums=e.list.map(function(t){return t.total_price}),t.buyTimeList.length&&t.totalNums.length&&t.drawLine()})},updateSize:function(t){this.page.pageSize=1,this.page.pageNum=t,this.getMaterialList()},updateNum:function(t){this.page.pageSize=t,this.getMaterialList()},downLoad:function(){var t=this;this.isDownload=1,this.startTime=this.$root.$options.filters.dateFormat(this.form.date[0],"YYYY/MM/DD"),this.lastTime=this.$root.$options.filters.dateFormat(this.form.date[1],"YYYY/MM/DD"),this.$exportExcel("/getMaterialList",{pageNum:this.page.pageNum,page:this.page.pageSize,lastTime:this.lastTime,startTime:this.startTime,download:this.isDownload}).then(function(){t.$message.success("下载成功")})},editMaterialsMessage:function(t){this.editMaterialMessage=t,this.dialogVisible=!0,t.material_cost_id?(this.form=t,this.form.buy_time=1e3*t.buy_time):(this.form.package_num="",this.form.package_price="",this.form.zipper_package_num="",this.form.zipper_package_price="",this.form.ticket_price="",this.form.ticket_num="",this.form.buy_time="",this.form.img_path="")},delMaterialMessage:function(t){var e=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$post("delMaterial",{material_cost_id:t.material_cost_id}).then(function(){e.$message.success("物料删除成功"),e.getMaterialList()})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},cancle:function(){this.dialogVisible=!1,this.$emit("close")},save:function(){var t=this;this.editMaterialMessage.material_cost_id?this.$post("editMaterial",{material_cost_id:this.editMaterialMessage.material_cost_id,package_num:this.form.package_num,package_price:this.form.package_price,zipper_package_num:this.form.zipper_package_num,zipper_package_price:this.form.zipper_package_price,ticket_price:this.form.ticket_price,ticket_num:this.form.ticket_num,buy_time:s()(this.form.buy_time).format("YYYY/MM/DD"),image:this.form.img_path}).then(function(){t.$message.success("物料信息修改成功"),t.dialogVisible=!1,t.$emit("close"),t.getMaterialList()}):this.$post("addMaterial",this.form).then(function(e){t.$message.success("物料新增成功"),t.dialogVisible=!1,t.$emit("close"),t.getMaterialList()})}},mounted:function(){this.getSiteList(),this.getMaterialList()}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("NavTemplent",{attrs:{title:"物料费用"}}),t._v(" "),a("div",{staticStyle:{padding:"15px 10% 15px 15px"}},[a("div",[a("h5",{staticStyle:{"font-weight":"bold"}},[t._v("数据筛选")]),t._v(" "),a("el-form",{staticStyle:{"margin-top":"15px"},attrs:{"label-width":"80px",inline:"",size:"mini"},nativeOn:{submit:function(t){t.preventDefault()}}},[a("el-date-picker",{staticStyle:{width:"250px"},attrs:{size:"mini",type:"daterange",format:"yyyy/MM/dd","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:t.getMaterialList},model:{value:t.form.date,callback:function(e){t.$set(t.form,"date",e)},expression:"form.date"}})],1)],1),t._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("div",{staticStyle:{width:"100%",height:"400px"},attrs:{id:"myChart"}})])],1),t._v(" "),a("div",{staticClass:"tableTitle"},[t._m(0),t._v(" "),a("span",{staticStyle:{width:"50%",float:"right","text-align":"right"}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.downLoad}},[a("i",{staticClass:"el-icon-download"}),t._v("导出")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.editMaterialsMessage}},[a("i",{staticClass:"el-icon-plus"}),t._v("新增")])],1)]),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.materialList,border:""}},[a("el-table-column",{attrs:{type:"index"}}),t._v(" "),a("el-table-column",{attrs:{label:"快递袋"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v("￥"+t._s(e.row.package_price||"--")+" （"+t._s(e.row.package_num)+"个)")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"包装拉链袋"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v("￥"+t._s(e.row.zipper_package_price||"--")+" （"+t._s(e.row.zipper_package_num)+"个)")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"热敏打印机"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v("￥"+t._s(e.row.ticket_num||"--")+" （"+t._s(e.row.ticket_price)+"个)")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"总费用"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.total_price||"--"))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.status?a("span",[t._v("待审核")]):1===e.row.status?a("span",[t._v("通过")]):a("span",[t._v("不通过")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"购买日期"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("dateFormat")(e.row.created_at,"YYYY/MM/DD")))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-link",{staticStyle:{color:"#409EFF"},on:{click:function(a){return t.editMaterialsMessage(e.row)}}},[t._v("编辑")]),t._v(" "),a("el-link",{staticStyle:{color:"#409EFF"},on:{click:function(a){return t.delMaterialMessage(e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),a("TablePage",{attrs:{pageSize:t.page.pageNum,pageNum:t.page.pageSize,total:t.total},on:{"update:pageSize":t.updateSize,"update:pageNum":t.updateNum}}),t._v(" "),a("el-dialog",{attrs:{title:t.title,visible:t.dialogVisible,width:"750px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",{attrs:{size:"mini"}},[a("el-form-item",{attrs:{label:"快递袋"}},[a("el-input",{staticStyle:{width:"40%"},attrs:{placeholder:"请输入个数（例如：50个）"},model:{value:t.form.package_num,callback:function(e){t.$set(t.form,"package_num",e)},expression:"form.package_num"}}),t._v(" "),a("el-input",{staticStyle:{width:"40%"},attrs:{placeholder:"请输入单价"},model:{value:t.form.package_price,callback:function(e){t.$set(t.form,"package_price",e)},expression:"form.package_price"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"包装拉链袋"}},[a("el-input",{staticStyle:{width:"40%"},attrs:{placeholder:"请输入个数（例如：50个）"},model:{value:t.form.zipper_package_num,callback:function(e){t.$set(t.form,"zipper_package_num",e)},expression:"form.zipper_package_num"}}),t._v(" "),a("el-input",{staticStyle:{width:"40%"},attrs:{placeholder:"请输入单价"},model:{value:t.form.zipper_package_price,callback:function(e){t.$set(t.form,"zipper_package_price",e)},expression:"form.zipper_package_price"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"热敏打印机"}},[a("el-input",{staticStyle:{width:"40%"},attrs:{placeholder:"请输入个数（例如：50个）"},model:{value:t.form.ticket_num,callback:function(e){t.$set(t.form,"ticket_num",e)},expression:"form.ticket_num"}}),t._v(" "),a("el-input",{staticStyle:{width:"40%"},attrs:{placeholder:"请输入单价"},model:{value:t.form.ticket_price,callback:function(e){t.$set(t.form,"ticket_price",e)},expression:"form.ticket_price"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"站点"}},[a("el-select",{attrs:{placeholder:"请选择站点"},model:{value:t.form.web_id,callback:function(e){t.$set(t.form,"web_id",e)},expression:"form.web_id"}},t._l(t.siteList,function(t){return a("el-option",{key:t.web_id,attrs:{value:t.web_id,label:t.web_name}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"购买日期"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:t.form.buy_time,callback:function(e){t.$set(t.form,"buy_time",e)},expression:"form.buy_time"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"总费用"}},[a("span",[t._v("￥"+t._s(t.form.total_price||0))])]),t._v(" "),a("el-form-item",{attrs:{label:"上传图片"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"https://jsonplaceholder.typicode.com/posts/","show-file-list":!1,"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload}},[t.form.img_path?a("img",{staticClass:"avatar",attrs:{src:t.form.img_path}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:t.cancle}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.save}},[t._v("确 定")])],1)],1)],1)],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticStyle:{width:"50%",float:"left"}},[e("div",[this._v("物料列表")])])}]};var c=a("VU/8")(o,n,!1,function(t){a("uq2y")},"data-v-05bb0486",null);e.default=c.exports},uq2y:function(t,e){}});
//# sourceMappingURL=45.3fe6620779ecefa0c200.js.map