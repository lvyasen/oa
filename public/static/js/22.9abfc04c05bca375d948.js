webpackJsonp([22],{"0lRA":function(e,t){},o8Yl:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=s("mvHQ"),i=s.n(l),o={components:{NavTemplent:s("15QY").a},data:function(){return{props:{label:"menu_name",children:"children"},menuIds:[],checkMenu:[],count:1,editUse:null,title:"角色信息",dialogVisible:!1,roleList:[],menuList:[],updateRole:null,form:{role_name:"",role_desc:""}}},methods:{getroleList:function(){var e=this;this.$post("/getRoleList").then(function(t){e.roleList=t.list})},getmenuList:function(){var e=this;this.$post("/getMenuList").then(function(t){e.menuList=t.filter(function(e){return 1===e.status})})},handleCheckChange:function(){this.menuIds=i()(this.$refs.tree.getCheckedKeys())},editUseMessage:function(e){this.updateRole=e,this.dialogVisible=!0,e.role_id?(this.form=e,this.checkMenu=JSON.parse(e.menu_list)):(this.form.role_name="",this.form.role_desc="",this.checkMenu=[])},updateStatus:function(e){var t=this;this.$post("editRoleStatus",{role_id:e.role_id}).then(function(e){t.getroleList(),t.$message.success("状态修改成功")})},cancle:function(){this.dialogVisible=!1,this.$emit("close")},save:function(){var e=this;""!==this.form.role_name?this.menuIds.length?this.updateRole.role_id?this.$post("editRole",{role_id:this.updateRole.role_id,role_name:this.form.role_name,menu_list:this.menuIds,role_desc:this.form.role_desc}).then(function(){e.$message.success("角色新增成功"),e.getroleList(),e.dialogVisible=!1,e.$emit("close")}):this.$post("addRole",{role_name:this.form.role_name,menu_list:this.menuIds,role_desc:this.form.role_desc}).then(function(){e.$message.success("角色新增成功"),e.getroleList(),e.dialogVisible=!1,e.$emit("close")}):this.$message.error("角色权限不能为空"):this.$message.error("角色名称不能为空")}},mounted:function(){this.getroleList(),this.getmenuList()}},n={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("NavTemplent",{attrs:{title:"角色管理"}}),e._v(" "),s("div",{staticStyle:{padding:"15px 10% 15px 15px"}},[s("div",{staticClass:"tableTitle"},[e._m(0),e._v(" "),s("span",{staticStyle:{width:"50%",float:"right","text-align":"right"}},[s("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.editUseMessage}},[s("i",{staticClass:"el-icon-plus"}),e._v("添加")])],1)]),e._v(" "),s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.roleList,border:""}},[s("el-table-column",{attrs:{type:"index"}}),e._v(" "),s("el-table-column",{attrs:{label:"角色"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.role_name||"--"))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"部门"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.name||"--"))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ccc"},on:{change:function(s){return e.updateStatus(t.row)}},model:{value:!!t.row.status,callback:function(s){e.$set(!!t.row,"status",s)},expression:"!!scope.row.status"}})]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(e._f("dateFormat")(1e3*t.row.update_time,"YYYY/MM/DD")))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-link",{staticStyle:{color:"#409EFF"},on:{click:function(s){return e.editUseMessage(t.row)}}},[e._v("编辑")])]}}])})],1),e._v(" "),s("el-dialog",{attrs:{title:e.title,visible:e.dialogVisible,width:"750px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[s("el-form",{attrs:{size:"mini"}},[s("el-form-item",{attrs:{label:"角色名称"}},[s("el-input",{attrs:{placeholder:"请输入角色名称"},model:{value:e.form.role_name,callback:function(t){e.$set(e.form,"role_name",t)},expression:"form.role_name"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"角色描述"}},[s("el-input",{attrs:{type:"textarea",maxlength:"100",placeholder:"请输入角色描述"},model:{value:e.form.role_desc,callback:function(t){e.$set(e.form,"role_desc",t)},expression:"form.role_desc"}})],1),e._v(" "),s("el-form-item",[s("label",[e._v("角色权限")]),e._v(" "),s("el-tree",{ref:"tree",attrs:{data:e.menuList,"show-checkbox":"","node-key":"menu_id","default-checked-keys":e.checkMenu,props:e.props},on:{"check-change":e.handleCheckChange}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"mini",type:"danger"},on:{click:e.cancle}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.save}},[e._v("确 定")])],1)],1)],1)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("span",{staticStyle:{width:"50%",float:"left"}},[t("div",[this._v("角色列表")])])}]};var a=s("VU/8")(o,n,!1,function(e){s("0lRA")},"data-v-55236b83",null);t.default=a.exports}});
//# sourceMappingURL=22.9abfc04c05bca375d948.js.map