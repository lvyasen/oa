webpackJsonp([17],{Y4J9:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s("mvHQ"),a=s.n(i),l=s("15QY"),r=s("8dnD"),o={components:{NavTemplent:l.a,TablePage:r.a},data:function(){return{editUserMessage:null,departmentList:[],page:{pageSize:1,pageNum:50},editUse:null,title:"用户信息",dialogVisible:!1,userList:[],roleList:[],total:0,updateStatusData:null,menu:!1,uditUser:!1,form:{note:"",departmentId:"",password:"",mobile:"",userName:"",department_id:"",email:"",name:"",role_id:[],status:0}}},methods:{getUserList:function(){var e=this;this.$post("/getUserList",{page:this.page.pageSize,pageNum:this.page.pageNum,user_name:this.form.userName,department_id:this.form.departmentId}).then(function(t){e.total=t.count,e.userList=t.list})},updateSize:function(e){this.page.pageSize=1,this.page.pageNum=e,this.getUserList()},updateNum:function(e){this.page.pageSize=e,this.getUserList()},getDepartmentList:function(){var e=this;this.$post("/getDepartmentList").then(function(t){e.departmentList=t.list}).catch(function(t){e.$message.error(t)})},getRoleList:function(){var e=this;this.$post("getRoleList").then(function(t){e.roleList=t.list.filter(function(e){return 1===e.status})})},editUseMessage:function(e){this.editUserMessage=e,this.dialogVisible=!0,e.id?(this.form=e,this.menu=!0,this.uditUser=!1):(this.form.mobile="",this.form.email="",this.form.name="",this.form.department_id="",this.form.role_id=[],this.menu=!1,this.uditUser=!1)},updateStatus:function(e){var t=this;this.editUserMessage=e,1===e.status?(this.dialogVisible=!0,this.uditUser=!0):this.$post("editUserStatus",{user_id:e.id}).then(function(e){t.getUserList(),t.$message.success("状态修改成功")})},cancle:function(){this.dialogVisible=!1,this.$emit("close")},save:function(){var e=this;this.editUserMessage.id?(this.form.mobile===this.editUserMessage.mobile?this.mobile=null:this.mobile=this.form.mobile,this.uditUser?this.$post("editUser",{email:this.editUserMessage.email,user_id:this.editUserMessage.id,user_name:this.editUserMessage.name,mobile:null,department_id:this.form.department_id,password:this.editUserMessage.password,role_list:a()(this.form.role_id)}).then(function(t){e.$post("editUserStatus",{user_id:e.editUserMessage.id}).then(function(t){e.$message.success("状态修改成功"),e.dialogVisible=!1,e.$emit("close"),e.getUserList()})}):this.$post("editUser",{email:this.form.email,user_id:this.editUserMessage.id,user_name:this.form.name,mobile:this.mobile,department_id:this.form.department_id,password:this.form.password}).then(function(t){e.$message.success("用户修改成功"),e.dialogVisible=!1,e.$emit("close"),e.getUserList()})):this.$post("signUp",{mobile:this.form.mobile,password:this.form.password,email:this.form.email,name:this.form.name,note:this.form.note}).then(function(){e.$message.success("用户新增成功"),e.dialogVisible=!1,e.$emit("close"),e.getUserList()})}},mounted:function(){this.getUserList(),this.getDepartmentList(),this.getRoleList()}},n={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("NavTemplent",{attrs:{title:"用户管理"}}),e._v(" "),s("div",{staticStyle:{padding:"15px 10% 15px 15px"}},[s("div",[s("h5",{staticStyle:{"font-weight":"bold"}},[e._v("数据筛选")]),e._v(" "),s("el-form",{staticStyle:{"margin-top":"15px"},attrs:{"label-width":"80px",inline:"",size:"mini"},nativeOn:{submit:function(e){e.preventDefault()}}},[s("el-form-item",{attrs:{label:"姓名"}},[s("el-input",{attrs:{placeholder:"请输入姓名"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getUserList(t)}},model:{value:e.form.userName,callback:function(t){e.$set(e.form,"userName",t)},expression:"form.userName"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"部门"}},[s("el-select",{attrs:{placeholder:"请选择部门"},on:{change:e.getUserList},model:{value:e.form.departmentId,callback:function(t){e.$set(e.form,"departmentId",t)},expression:"form.departmentId"}},e._l(e.departmentList,function(e){return s("el-option",{key:e.department_id,attrs:{value:e.department_id,label:e.department_name}})}),1)],1)],1)],1),e._v(" "),s("div",{staticClass:"tableTitle"},[e._m(0),e._v(" "),s("span",{staticStyle:{width:"50%",float:"right","text-align":"right"}},[s("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.editUseMessage}},[s("i",{staticClass:"el-icon-plus"}),e._v("添加")])],1)]),e._v(" "),s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.userList,border:""}},[s("el-table-column",{attrs:{type:"index"}}),e._v(" "),s("el-table-column",{attrs:{label:"用户名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.name||"--"))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"部门"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.department_name||"--"))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"角色"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.role_name||"--"))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ccc"},on:{change:function(s){return e.updateStatus(t.row)}},model:{value:!!t.row.status,callback:function(s){e.$set(!!t.row,"status",s)},expression:"!!scope.row.status"}})]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(e._f("dateFormat")(t.row.created_at,"YYYY/MM/DD")))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-link",{staticStyle:{color:"#409EFF"},on:{click:function(s){return e.editUseMessage(t.row)}}},[e._v("编辑")])]}}])})],1),e._v(" "),s("TablePage",{attrs:{pageSize:e.page.pageNum,pageNum:e.page.pageSize,total:e.total},on:{"update:pageSize":e.updateSize,"update:pageNum":e.updateNum}}),e._v(" "),s("el-dialog",{attrs:{title:e.title,visible:e.dialogVisible,width:"750px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[s("el-form",{attrs:{size:"mini"}},[e.uditUser?e._e():s("el-form-item",{attrs:{label:"姓名"}},[s("el-input",{attrs:{placeholder:"请输入部门负责人名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),e.uditUser?e._e():s("el-form-item",{attrs:{label:"手机号"}},[s("el-input",{attrs:{placeholder:"请输入手机号"},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1),e._v(" "),e.uditUser?e._e():s("el-form-item",{attrs:{label:"密码"}},[s("el-input",{attrs:{type:"password",placeholder:"******"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),e._v(" "),e.uditUser?e._e():s("el-form-item",{attrs:{label:"邮箱"}},[s("el-input",{attrs:{placeholder:"请输入邮箱"},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"部门"}},[s("el-input",{attrs:{placeholder:"请输入备注部门"},model:{value:e.form.note,callback:function(t){e.$set(e.form,"note",t)},expression:"form.note"}})],1),e._v(" "),e.uditUser?s("el-form-item",{attrs:{label:"角色"}},[s("el-select",{attrs:{placeholder:"请选择角色",multiple:""},model:{value:e.form.role_id,callback:function(t){e.$set(e.form,"role_id",t)},expression:"form.role_id"}},e._l(e.roleList,function(e){return s("el-option",{key:e.role_id,attrs:{label:e.role_name,value:e.role_id}})}),1)],1):e._e()],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"mini",type:"danger"},on:{click:e.cancle}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.save}},[e._v("确 定")])],1)],1)],1)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("span",{staticStyle:{width:"50%",float:"left"}},[t("div",[this._v("用户列表")])])}]};var m=s("VU/8")(o,n,!1,function(e){s("e1Nf")},"data-v-72096d0d",null);t.default=m.exports},e1Nf:function(e,t){}});
//# sourceMappingURL=17.922fc2a2b11d3575d24d.js.map