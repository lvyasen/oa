webpackJsonp([8],{YVwx:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={components:{NavTemplent:a("15QY").a},data:function(){return{isDepartment:!1,editUse:null,title:"部门信息",dialogVisible:!1,departmentMessage:null,userList:[],departmentNameList:[],departmentList:[],total:0,form:{department_name:"",desc:"",department_manager:"",pid:"",manager_user_id:""}}},methods:{editDepartment:function(t){this.isDepartment=!0,this.dialogVisible=!0,this.departmentMessage=t,t.department_id?(this.form.department_manager=t.department_manager,this.form.desc=t.desc,this.form.department_name=t.department_name,this.form.pid=t.pid):(this.form.department_manager="",this.form.desc="",this.form.department_name="",this.form.pid="")},cancle:function(){this.dialogVisible=!1,this.$emit("close")},save:function(){var t=this;""!==this.form.department_name?""!==this.form.department_manager?""!==this.form.pid?this.departmentMessage.department_id?(this.form.department_id=this.departmentMessage.department_id,this.$post("editDepartment",this.form).then(function(e){t.$message.success("部门修改成功")})):(this.manageUser=this.userList.map(function(e){return e.id===t.form.department_manager}),this.$post("addDepartment",{department_name:this.form.department_name,department_manager:this.manageUser.name,pid:this.form.pid,desc:this.form.desc,manager_user_id:this.form.department_manager}).then(function(e){t.getDepartmentList(),t.dialogVisible=!1,t.$emit("close")})):this.$message.error("上级部门不能为空"):this.$message.error("部门负责人不能为空"):this.$message.error("部门名称不能为空")},getDepartmentList:function(){var t=this;this.$post("/getDepartmentList").then(function(e){t.total=e.length,t.departmentList=e.list,t.departmentNameList=e.list.map(function(t){return{department_name:t.department_name,pid:t.department_id}})})},getUserList:function(){var t=this;this.$post("/getUserList").then(function(e){t.total=e.count,t.userList=e.list})}},mounted:function(){this.getUserList(),this.getDepartmentList()}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("NavTemplent",{attrs:{title:"部门管理"}}),t._v(" "),a("div",{staticStyle:{padding:"15px 10% 15px 15px"}},[a("div",{staticClass:"tableTitle"},[t._m(0),t._v(" "),a("span",{staticStyle:{width:"50%",float:"right","text-align":"right"}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.editDepartment}},[a("i",{staticClass:"el-icon-plus"}),t._v("添加")])],1)]),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.departmentList,"row-key":"department_id",border:"",lazy:"","tree-props":{children:"children",hasChildren:"hasChildren"}}},[a("el-table-column",{attrs:{type:"index"}}),t._v(" "),a("el-table-column",{attrs:{label:"部门名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.department_name||"--"))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"部门负责人"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.department_manager||"--"))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"部门人数"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.department_num||"--"))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-link",{staticStyle:{color:"#409EFF"},on:{click:function(a){return t.editDepartment(e.row)}}},[t._v("编辑")])]}}])})],1),t._v(" "),a("el-dialog",{attrs:{title:t.title,visible:t.dialogVisible,width:"750px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",{attrs:{size:"mini"}},[a("el-form-item",{attrs:{label:"部门名称"}},[a("el-input",{attrs:{placeholder:"请输入部门名称"},model:{value:t.form.department_name,callback:function(e){t.$set(t.form,"department_name",e)},expression:"form.department_name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"部门描述"}},[a("el-input",{attrs:{type:"textarea",maxlength:"100","show-word-limit":"",placeholder:"请输入部门描述"},model:{value:t.form.desc,callback:function(e){t.$set(t.form,"desc",e)},expression:"form.desc"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"部门负责人"}},[a("el-select",{attrs:{placeholder:"请选择部门负责人"},model:{value:t.form.department_manager,callback:function(e){t.$set(t.form,"department_manager",e)},expression:"form.department_manager"}},t._l(t.userList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"上级部门"}},[a("el-select",{attrs:{placeholder:"请选择上级部门"},model:{value:t.form.pid,callback:function(e){t.$set(t.form,"pid",e)},expression:"form.pid"}},[a("el-option",{attrs:{label:"新增部门",value:0}}),t._v(" "),t._l(t.departmentNameList,function(t){return a("el-option",{key:t.pid,attrs:{label:t.department_name,value:t.pid}})})],2)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:t.cancle}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.save}},[t._v("确 定")])],1)],1)],1)],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticStyle:{width:"50%",float:"left"}},[e("div",[this._v("部门列表")])])}]};var i=a("VU/8")(n,r,!1,function(t){a("q0CG")},"data-v-cdac72c4",null);e.default=i.exports},q0CG:function(t,e){}});
//# sourceMappingURL=8.e0d8b8131053a2d98d8f.js.map